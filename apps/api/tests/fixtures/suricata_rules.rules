# Suricata rules for testing

# Malware Communication
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET MALWARE Suspicious Outbound Connection"; flow:established,to_server; content:"GET"; http_method; content:"/gate.php"; http_uri; classtype:trojan-activity; sid:2000001; rev:1;)

# PowerShell Empire Detection
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN PowerShell Empire HTTP Checkin"; flow:established,to_server; content:"GET"; http_method; content:"session="; http_uri; content:"&stagingkey="; http_uri; classtype:trojan-activity; sid:2000002; rev:1;)

# Cobalt Strike Beacon
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Cobalt Strike Beacon"; flow:established; content:"|00 00|"; offset:0; depth:2; content:"|be ef|"; distance:0; classtype:trojan-activity; sid:2000003; rev:1;)

# DNS Tunneling
alert dns $HOME_NET any -> any any (msg:"ET POLICY DNS Query for Suspicious TLD"; dns_query; content:".tk"; nocase; endswith; classtype:policy-violation; sid:2000004; rev:1;)

# SSH Brute Force
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:"ET SCAN SSH BruteForce Tool frequent connections"; flow:established; detection_filter:track by_src, count 5, seconds 60; classtype:attempted-recon; sid:2000005; rev:1;)

# File Download
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET POLICY Executable Download"; flow:established,to_server; content:"GET"; http_method; content:".exe"; http_uri; endswith; classtype:policy-violation; sid:2000006; rev:1;)

# Suspicious User Agent
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Suspicious User Agent"; flow:established,to_server; content:"User-Agent|3a 20|PowerShell"; classtype:trojan-activity; sid:2000007; rev:1;)

# Base64 Encoded Content
alert http any any -> any any (msg:"ET POLICY Base64 Encoded Executable in HTTP"; flow:established; file_data; content:"TVqQAAMAAAAEAAAA"; classtype:policy-violation; sid:2000008; rev:1;)

# Port Scan Detection
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET SCAN Port Scan Detected"; flags:S; detection_filter:track by_src, count 10, seconds 60; classtype:attempted-recon; sid:2000009; rev:1;)

# Lateral Movement
alert smb $HOME_NET any -> $HOME_NET any (msg:"ET POLICY SMB Admin Share Access"; flow:established; content:"ADMIN$"; classtype:policy-violation; sid:2000010; rev:1;)